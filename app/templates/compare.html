{% extends "base.html" %}

{% block title %}Compare Schools - NSW School Finder{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <div class="mb-6">
        <a href="javascript:history.back()" class="text-black hover:underline font-hand mb-4 inline-block">← Back</a>
        <h1 class="text-3xl sm:text-4xl font-hand font-bold text-black mb-2">
            Compare Schools
        </h1>
    </div>

    {% if schools|length == 0 %}
    <div class="bg-gray-50 border-2 border-gray-300 rounded-lg p-8 text-center">
        <p class="text-lg text-gray-700 font-sans">No schools selected for comparison.</p>
        <a href="/" class="text-black hover:underline font-hand mt-4 inline-block">Search for schools</a>
    </div>
    {% else %}
    <div class="bg-white border-2 border-black rounded-lg p-4 sm:p-6 overflow-x-auto">
        <table class="w-full border-collapse font-sans">
            <thead>
                <tr class="border-b-2 border-black">
                    <th class="text-left p-2 font-hand font-bold text-black"></th>
                    {% for school in schools %}
                    <th class="text-left p-2 font-hand font-bold text-black">{{ school.school_name }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Level</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">{{ school.level_of_schooling }}</td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Distance</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {% if school.distance is not none %}
                            {{ school.distance }} km away
                        {% else %}
                            Not available
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Location</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {{ school.town_suburb }}{% if school.postcode %}, {{ school.postcode }}{% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Address</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">{{ school.street }}</td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Gender</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">{{ school.gender }}</td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">School Size</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {{ school.school_size }}
                        {% if school.enrolment_raw %}
                        <span class="text-xs text-gray-500">({{ "%.0f"|format(school.enrolment_raw) }} students)</span>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Community</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">{{ school.community }}</td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Special Features</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {% if school.special_features %}
                            {% for feature in school.special_features %}
                            <span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mb-1 mr-1">{{ feature }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="text-gray-500">None listed</span>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr class="border-b border-gray-300">
                    <td class="p-2 font-semibold text-black">Selective</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">{{ school.selective_school }}</td>
                    {% endfor %}
                </tr>
                {% if schools|selectattr("icsea_value")|list|length > 0 %}
                <tr class="border-b-2 border-black">
                    <td class="p-2 font-semibold text-black">ICSEA Value</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {% if school.icsea_value %}
                            {{ school.icsea_value }}
                        {% else %}
                            Not available
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                <tr>
                    <td colspan="{{ schools|length + 1 }}" class="p-4 bg-gray-50 border-t-2 border-gray-300">
                        <p class="font-sans text-sm text-gray-700 italic">
                            ICSEA shows the general socio-educational background of students at a school. It does not measure school quality or teaching performance.
                        </p>
                    </td>
                </tr>
                {% endif %}
                <tr class="border-t-2 border-black">
                    <td class="p-2 font-semibold text-black">Contact</td>
                    {% for school in schools %}
                    <td class="p-2 text-gray-700">
                        {% if school.phone %}
                            <p class="text-sm">Phone: <a href="tel:{{ school.phone }}" class="text-blue-600 hover:underline">{{ school.phone }}</a></p>
                        {% endif %}
                        {% if school.school_email %}
                            <p class="text-sm">Email: <a href="mailto:{{ school.school_email }}" class="text-blue-600 hover:underline">{{ school.school_email }}</a></p>
                        {% endif %}
                        {% if school.website %}
                            <p class="text-sm">Website: <a href="{{ school.website }}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Visit</a></p>
                        {% endif %}
                        <a href="/school/{{ school.id }}" class="text-sm text-blue-600 hover:underline font-hand">View Details →</a>
                    </td>
                    {% endfor %}
                </tr>
            </tbody>
        </table>
    </div>
    {% endif %}
</div>
{% endblock %}
